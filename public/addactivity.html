<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
  
  <title>Coasty Check - Add Activity</title>
  
  <style>
    :root {
      --primary-color: #1abc9c;
      --primary-hover: #0e5144;
      --light-bg: #f5f5f5;
      --white: #fff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --border-radius: 10px;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--light-bg);
      min-height: 100vh;
      display: flex;
    }
    
    /* Sidebar Styles */
    #sidebar {
      width: 260px;
      background: var(--white);
      height: 100vh;
      position: fixed;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      z-index: 100;
    }
    
    #sidebar .brand {
      display: flex;
      align-items: center;
      padding: 20px;
      text-decoration: none;
      color: var(--primary-color);
      font-size: 18px;
      font-weight: bold;
    }
    
    #sidebar .brand i {
      margin-right: 10px;
      font-size: 24px;
    }
    
    #sidebar .side-menu {
      list-style-type: none;
      margin: 20px 0;
    }
    
    #sidebar .side-menu li {
      margin-bottom: 5px;
    }
    
    #sidebar .side-menu a {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      text-decoration: none;
      color: #333;
      transition: all 0.3s ease;
    }
    
    #sidebar .side-menu a:hover, 
    #sidebar .side-menu li.active a {
      background: var(--primary-color);
      color: var(--white);
    }
    
    #sidebar .side-menu a i {
      margin-right: 12px;
      font-size: 20px;
    }
    
    /* Content Styles */
    #content {
      margin-left: 260px;
      width: calc(100% - 260px);
      transition: all 0.3s ease;
    }
    
    .head-title {
      padding: 20px;
    }
    
    .head-title h1 {
      font-size: 28px;
      margin-bottom: 10px;
      color: #333;
    }
    
    .breadcrumb {
      display: flex;
      list-style-type: none;
      margin-bottom: 20px;
    }
    
    .breadcrumb li {
      margin-right: 5px;
    }
    
    .breadcrumb a {
      color: #666;
      text-decoration: none;
    }
    
    .breadcrumb .active {
      color: var(--primary-color);
    }
    
    .main-container {
      display: flex;
      gap: 30px;
      width: 95%;
      max-width: 1800px;
      margin: 0 auto 30px;
    }
    
    .form-container {
      background: var(--white);
      padding: 30px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      flex: 1;
    }
    
    .activities-container {
      background: var(--white);
      padding: 30px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      flex: 1.5;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    h1, h2 {
      font-size: 24px;
      margin-bottom: 25px;
      text-align: center;
      color: #333;
      position: relative;
    }
    
    h1:after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: var(--primary-color);
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #555;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 15px;
      transition: border 0.2s;
      font-family: inherit;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(26, 188, 156, 0.2);
    }
    
    textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    button {
      width: 100%;
      padding: 14px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: background-color 0.2s;
    }
    
    button:hover {
      background-color: var(--primary-hover);
    }
    
    .activity-list {
      margin-top: 20px;
    }
    
    .activity-item {
      background: #f9f9f9;
      padding: 20px;
      margin-bottom: 15px;
      border-radius: 8px;
      position: relative;
      border-left: 5px solid var(--primary-color);
    }
    
    .activity-item h4 {
      margin: 0 0 12px 0;
      color: #333;
      font-size: 18px;
    }
    
    .activity-item p {
      margin-bottom: 8px;
      line-height: 1.5;
      color: #666;
    }
    
    .activity-item small {
      display: block;
      margin-top: 10px;
      color: #999;
      font-style: italic;
    }
    
    .actions {
      position: absolute;
      top: 15px;
      right: 15px;
    }
    
    .actions button {
      background: #ff5252;
      border: none;
      color: white;
      cursor: pointer;
      padding: 6px 12px;
      border-radius: 4px;
      width: auto;
      font-size: 14px;
      font-weight: normal;
    }
    
    .actions button:hover {
      background: #e03e3e;
    }
    
    /* Filter Section */
    #filterSection {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
  </style>
</head>
<body>

  <!-- SIDEBAR -->
  <section id="sidebar">
    <a href="#" class="brand">
      <i class='bx bxs-smile'></i>
      <span class="text">Activity Manager</span>
    </a>
    <ul class="side-menu top">
      <li>
        <a href="index.html">
          <i class='bx bxs-dashboard'></i>
          <span class="text">Dashboard</span>
        </a>
      </li>
      <li class="active">
        <a href="addactivity.html">
          <i class='bx bx-swim'></i>
          <span class="text">ADD Activity</span>
        </a>
      </li>
      <li>
        <a href="addnotification.html">
          <i class='bx bxs-message-dots'></i>
          <span class="text">ADD Notifications</span>
        </a>
      </li>
      <li>
        <a href="review.html">
          <i class='bx bx-align-justify'></i>
          <span class="text">Reviews</span>
        </a>
      </li>
      <li>
        <a href="profile.html">
          <i class='bx bxs-user-circle'></i>
          <span class="text">Profile</span>
        </a>
      </li>
      <li>
        <a href="login.html" class="logout">
          <i class='bx bxs-log-out-circle'></i>
          <span class="text">Logout</span>
        </a>
      </li>
    </ul>
  </section>
  <!-- SIDEBAR -->

  <!-- CONTENT -->
  <section id="content">
    <!-- MAIN -->
    <main>
      <div class="head-title">
        <div class="left">
          <h1>Add New Beach Activity</h1>
          <ul class="breadcrumb">
            <li>
              <a href="index.html">Dashboard</a>
            </li>
            <li><i class='bx bx-chevron-right'></i></li>
            <li>
              <a class="active" href="#">Add Activity</a>
            </li>
          </ul>
        </div>
      </div>
      
      <div class="main-container">
        <!-- Form -->
        <div class="form-container">
          <h1>Add Beach Activities</h1>
          
          <div class="form-group">
            <label for="beachName">Beach Name:</label>
            <select id="beachName">
              <option value="">Select Beach</option>
              <option value="Munambam Beach">Munambam Beach</option>
              <option value="Kuzhupilly Beach">Kuzhupilly Beach</option>
              <option value="Puthuvype Beach">Puthuvype Beach</option>
              <option value="Cherai Beach">Cherai Beach</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="activityName">Activity Type:</label>
            <select id="activityName">
              <option value="">Select Activity Name</option>
              <option value="Snorkeling">Snorkeling</option>
              <option value="Jet Skiing">Jet Skiing</option>
              <option value="Parasailing">Parasailing</option>
              <option value="Boating">Boating</option>
              <option value="Scuba Diving">Scuba Diving</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="activityDescription">Activity Description:</label>
            <textarea id="activityDescription" placeholder="Provide details about the activity..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="activityDate">Activity Date:</label>
            <input type="date" id="activityDate">
          </div>
          
          <div class="form-group">
            <label for="startTime">Start Time:</label>
            <input type="time" id="startTime">
          </div>
          
          <div class="form-group">
            <label for="endTime">End Time:</label>
            <input type="time" id="endTime">
          </div>
          
          <div class="form-group">
            <label for="activityPrice">Price (optional):</label>
            <input type="text" id="activityPrice" placeholder="e.g., â‚¹500 per person">
          </div>
          
          <div class="form-group">
            <label for="contactInfo">Contact Information:</label>
            <input type="text" id="contactInfo" placeholder="Phone number or email">
          </div>
          
          <button id="addActivityButton">Add Activity</button>
        </div>
        
        <!-- Activity List -->
        <div class="activities-container">
          <h1>Existing Beach Activities</h1>
          <div id="filterSection">
            <h2>Filter Activities</h2>
            <select id="beachFilter">
              <option value="">All Beaches</option>
              <option value="Munambam Beach">Munambam Beach</option>
              <option value="Kuzhupilly Beach">Kuzhupilly Beach</option>
              <option value="Puthuvype Beach">Puthuvype Beach</option>
              <option value="Cherai Beach">Cherai Beach</option>
            </select>
          </div>
          <div class="activity-list" id="activityList"></div>
        </div>
      </div>
    </main>
  </section>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
    import { getDatabase, ref, set, push, onValue, remove } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCEG79vjoQAQ2CKeUTIoORk2VSdldXF33E",
      authDomain: "yash-9dd33.firebaseapp.com",
      databaseURL: "https://yash-9dd33-default-rtdb.firebaseio.com",
      projectId: "yash-9dd33",
      storageBucket: "yash-9dd33.firebasestorage.app",
      messagingSenderId: "933477566768",
      appId: "1:933477566768:web:5fa44573d34c86fa4c60f5",
      measurementId: "G-ZP9YZX8Q14"
    };
    
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const activityList = document.getElementById('activityList');
    const beachFilter = document.getElementById('beachFilter');

    // Add Activity
    document.getElementById('addActivityButton').addEventListener('click', async () => {
      const beachName = document.getElementById('beachName').value.trim();
      const activityName = document.getElementById('activityName').value.trim();
      const activityDescription = document.getElementById('activityDescription').value.trim();
      const activityDate = document.getElementById('activityDate').value;
      const startTime = document.getElementById('startTime').value.trim();
      const endTime = document.getElementById('endTime').value.trim();
      const activityPrice = document.getElementById('activityPrice').value.trim();
      const contactInfo = document.getElementById('contactInfo').value.trim();

      if (beachName && activityName && activityDescription && activityDate && startTime && endTime && contactInfo) {
        try {
          const newActivityRef = push(ref(db, 'beach-activities'));
          await set(newActivityRef, {
            beachName,
            activityName,
            description: activityDescription,
            activityDate,
            startTime,
            endTime,
            price: activityPrice || 'Not specified',
            contactInfo,
            timestamp: Date.now()
          });
          alert("Activity added successfully!");
          
          // Clear input fields
          document.getElementById('beachName').value = '';
          document.getElementById('activityName').value = '';
          document.getElementById('activityDescription').value = '';
          document.getElementById('activityDate').value = '';
          document.getElementById('startTime').value = '';
          document.getElementById('endTime').value = '';
          document.getElementById('activityPrice').value = '';
          document.getElementById('contactInfo').value = '';
        } catch (error) {
          console.error("Error adding activity:", error);
          alert("Failed to add activity. Please try again.");
        }
      } else {
        alert("Please fill out all required fields.");
      }
    });

    // Fetch and Filter Activities
    const fetchActivities = () => {
      onValue(ref(db, 'beach-activities'), (snapshot) => {
        activityList.innerHTML = '';
        const selectedBeach = beachFilter.value;

        snapshot.forEach((childSnapshot) => {
          const key = childSnapshot.key;
          const data = childSnapshot.val();

          // Filter activities based on selected beach
          if (selectedBeach === '' || data.beachName === selectedBeach) {
            const activityItem = document.createElement('div');
            activityItem.className = 'activity-item';
            activityItem.innerHTML = ` 
              <h4>${data.activityName} at ${data.beachName}</h4>
              <p><strong>Description:</strong> ${data.description}</p>
              <p><strong>Date:</strong> ${data.activityDate || 'Not specified'}</p>
              <p><strong>Time:</strong> ${data.startTime} - ${data.endTime}</p>
              <p><strong>Price:</strong> ${data.price}</p>
              <p><strong>Contact:</strong> ${data.contactInfo}</p>
              <small>Added on: ${new Date(data.timestamp).toLocaleString()}</small>
              <div class="actions">
                <button onclick="deleteActivity('${key}')">Delete</button>
              </div>
            `;
            activityList.appendChild(activityItem);
          }
        });
      });
    };

    // Delete Activity
    window.deleteActivity = (key) => {
      if (confirm("Are you sure you want to delete this activity?")) {
        remove(ref(db, 'beach-activities/' + key))
          .then(() => {
            alert("Activity deleted successfully!");
            fetchActivities();
          })
          .catch((error) => {
            console.error("Error deleting activity:", error);
            alert("Failed to delete activity.");
          });
      }
    };

    // Add event listener for beach filter
    beachFilter.addEventListener('change', fetchActivities);

    // Initialize activities list
    fetchActivities();
  </script>
</body>
</html>